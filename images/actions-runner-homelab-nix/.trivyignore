# =========================================================================================================
# Trivy Ignore Configuration for ARC Runner
# Goal: Suppress false positives and unfixable upstream vulnerabilities in the base image.
# =========================================================================================================

# -----------------
# Secrets (False Positives)
# -----------------
# These are test keys and patches embedded in the Nix installer/store, not real runtime secrets.
**/ssh_host_ed25519_key
**/*.pem
**/*.patch

# -----------------
# Base Image Vulnerabilities (ghcr.io/actions/actions-runner)
# -----------------
# These vulnerabilities are baked into the upstream runner image. We cannot fix them without patching
# the runner itself or waiting for GitHub to release a new image.

# Node.js Libraries (used by runner)
CVE-2026-25547  # @isaacs/brace-expansion (Denial of Service)
CVE-2024-21538  # cross-spawn (ReDoS)
CVE-2025-64756  # glob (Command Injection)
CVE-2026-23745  # tar (Arbitrary file overwrite/symlink poisoning)
CVE-2026-23950  # tar (Arbitrary file overwrite)
CVE-2026-24842  # tar (Path traversal)

# Container Runtime & Docker (bundled in runner)
# These affect runc, containerd (CVE-2025-52881 escape), and golang stdlib issues.
CVE-2025-68121  # golang crypto/tls (DoS)
CVE-2026-24051  # go.opentelemetry.io/otel/sdk (PATH hijacking, fixed in v1.40.0)

# -----------------
# Nix Installer Bundled Tools (Rust/Go dependencies in /nix/store)
# -----------------
# These come from the Nix installer binary blob. We upgraded Nix to 2.33.2 to attempt a fix,
# but retain ignores for known issues in case they persist. These are build-time tools usually not exploitable at runtime.

# Rust Crates (xcb, crossbeam, etc.)
CVE-2021-26955  # xcb (Use-after-free)
CVE-2021-26956  # xcb (Use-after-free)
CVE-2021-26957  # xcb (Use-after-free)
CVE-2021-26958  # xcb (Use-after-free)
CVE-2018-20993  # yaml-rust (DoS recursion)
CVE-2024-27308  # mio (rpm-ostree specific)
GHSA-8qv2-5vq6-g2g7 # webpki (DoS)
CVE-2021-32810  # crossbeam-deque (Double free)
CVE-2022-23639  # crossbeam-utils (Use-after-free/race)
GHSA-rvr2-r3pv-5m4p # oneshot (Use-after-free)
CVE-2024-32650  # rustls (DoS)
CVE-2022-24713  # regex (ReDoS)
GHSA-9g55-pg62-m8hh # crossbeam-channel (Data leak)
GHSA-wgrg-5h56-jg27 # nix (Out-of-bounds write)
CVE-2026-23519  # cmov (Side-channel)
CVE-2025-11695  # mongodb (Certificate validation bypass)
GHSA-47qc-857f-7w7f # pyo3 (Type confusion with abi3 subclass access)

# -----------------
# Actions Runner Bundled Node.js Dependencies (actions/runner v2.331.0)
# -----------------
# These vulnerabilities are in npm packages bundled within the runner binary itself.
# They will be fixed when GitHub releases a new runner version with updated dependencies.

# minimatch - ReDoS via repeated wildcards with non-matching literal in pattern
CVE-2026-26996

# minimatch - ReDoS via unbounded recursive backtracking in matchOne()
CVE-2026-27903

# minimatch - ReDoS via catastrophic backtracking in nested extglobs
CVE-2026-27904

# tar (node-tar) - Arbitrary File Read/Write via Hardlink Target Escape Through Symlink Chain
CVE-2026-26960
